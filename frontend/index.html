<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Tour and Travel </title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!-- css  -->
    <link rel="stylesheet" href="public/css/sty.css">
    <script type="text/javascript" src="./public/javascript/nav.js"></script>


</head>

<body>

    <nav class="nav">
        <div class="container">

            <h1 class="logog"><a href="#container">Mywebsite</a> </h1>
            <ul>
                <li><a href="#banner" class="current">Home</a></li>
                <li><a href="#about">About Us</a></li>
                <li><a href="#tour">Tours</a></li>
                <li><a href="#media">Media</a></li>
                <li><a href="#contact">Contact Us</a></li>
                <li><a id="nameorlogin" href="./Login.html">Login</a></li>
                <li><a id="addtour" style="display: none;" href="./addtour.html">Add tour</a></li>
                <li><a id="adduser" style="display: none;" href="./SignUp.html">Add Admin</a></li>

            </ul>
            <div class="btn-group">
                <a href="#" class="btn btn-try">
                    <span>Book A Tour</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- main  -->
    <main>

        <!-- banner  -->

        <section class="banner" id="banner">
            <div class="banner-text">
                <h1>Tour and Travel </h1>
                <P>Tour and Travel provides u the best tourism places. Book online.</P>
                <a href="#" class="btn btn-get"><span>Explore</span></a>
            </div>
            <div class="overlay2">

            </div>
        </section>
        <!-- explore  -->
        <section class="explore" id="explore">
            <div class="main-text">
                <h2>Explore</h2>
                <h1><span>N</span>epal</h1>
                <p>This place amazes with its fabulous atmosphere and nature</p>
            </div>
            <div class="main-container">
                <div class="image-box image-1">
                    <img src='./public/img/ktm.jpg' alt="">
                    <div class="overlay"></div>
                    <div class="image-box-text">
                        <h2>Kathmandu</h2>
                        <p>Capital city of Nepal</p>
                    </div>
                </div>
                <div class="image-box image-1">
                    <img src="./public/img/everest.jpg" alt="">
                    <div class="overlay"></div>
                    <div class="image-box-text">
                        <h2>Everest</h2>
                        <p>Highest Mountain</p>
                    </div>
                </div>
                <div class="image-box image-1">
                    <img src="./public/img/phewa lake.jpg" alt="">
                    <div class="overlay"></div>
                    <div class="image-box-text">
                        <h2>Pokhara</h2>
                        <p>Phewa Lake</p>
                    </div>
                </div>
            </div>
            <button class="btn btn-view-all">
                View More
            </button>
        </section>

        <!-- about  -->
        <section class="about" id="about">
            <div class="main-text">
                <h2>About</h2>
                <h1>Unforgettable <span>S</span>ensations</h1>
                <p>Tour and Travel can help you plan the perfect trip to Nepal. We can help you book the most
                    comfortable and convenient hotels, so you can focus on enjoying your
                    adventure in Nepal. Whether you want to trek to the base camp of Mount Everest, explore the ancient
                    cities of Kathmandu and Bhaktapur, or go on a wildlife safari in Chitwan National Park, we can make
                    it happen.</p>
            </div>
            <div class="main-container">
                <video src="public/img/playback.mp4" autoplay loop muted></video>
            </div>
            <!-- tour  -->

            <section class="tour" id="tour">
                <div class="main-text">
                    <h2>2023</h2>
                    <h1>Tours</h1>
                </div>
                <div class="main-container" id="main-container">
                    <!-- // card 1 -->

                    <!-- ------ -->
                    <!-- card 2 -->

                    <!-- ------  -->

                    <!-- cards 3  -->
                    <div class="tour-cards">
                        <div class="image-box">
                            <img src="./public/img/annapurna.jpg" alt="annapurna ">
                            <div class="overlay"></div>
                            <div class="image-box-text">
                                <h2>Annapurna</h2>
                                <p>Mountains & Trekking</p>
                            </div>

                        </div>
                        <div class="tour-cards-text">
                            <h1>Annapurna Basecamp Trip</h1>
                            <p>Welcome to the Annapurna Base Camp trek, one of the most popular and scenic treks in
                                Nepal. This trek takes you through a diverse landscape of lush forests, terraced fields,
                                traditional villages, and stunning mountain vistas, culminating in the breathtaking view
                                of the Annapurna massif from the base camp.</p>
                            <a href="#" class="btn-map">

                                <span>View Route Map</span>
                            </a>
                            <div class="price">
                                <p>$5200 <span>Per person</span></p>
                                <h2>18 Days 36 Nights</h2>
                            </div>
                        </div>
                    </div>
                    <!-- ------ -->
                </div>
                <button class="btn btn-view-all">
                    View More
                </button>
            </section>


            <!-- ----- -->
            <!-- media  -->

            <section class="media" id="media">
                <div class="main-text">
                    <h2>Media</h2>
                    <h1>Nepal Footage</h1>
                </div>
                <div class="main-container">
                    <div class="image image-1">
                        <img src="./public/img/dadeldhura.jpg" alt="dadeldhura">
                        <h3>Dadeldhura Snowfall</h3>
                    </div>
                    <div class="image image-2">
                        <img src="./public/img/everest2.jpg" alt="everest2 ">
                        <h3>Everest Viewtour</h3>
                    </div>
                    <div class="image image-3">
                        <img src="./public/img/lumbini.jpg" alt="lumbini">
                        <h3>Lumbini</h3>
                    </div>
                    <div class="image image-4">
                        <img src="./public/img/narayani.jpg" alt="Narayani">
                        <h3>Narayani River</h3>
                    </div>
                    <div class="image image-5">
                        <img src="./public/img/monkey.jpg" alt="monkey">
                        <h3>Nepal's monkey</h3>
                    </div>
                    <div class="image image-6">
                        <img src="./public/img/pashupati.jpg" alt=" pashupati">
                        <h3>Pashupatinath jogi</h3>
                    </div>
                    <div class="image image-7">
                        <img src="./public/img/parrot.jpg" alt="parrot">
                        <h3>Mardi Himal</h3>
                    </div>
                    <div class="image image-8">
                        <img src="./public/img/gosaikunda.jpg" alt="gosaikunda">
                        <h3>Gosaikunda</h3>
                    </div>
                    <div class="image image-9">
                        <img src="./public/img/shiv.jpg" alt=" shiv">
                        <h3> Shiva </h3>
                    </div>

                </div>
            </section>

            <!-- ----- -->

            <!-- contact  -->
            <section class="contact" id="contact">
                <div class="main-text">
                    <h2>Contact</h2>
                    <h1>Get in touch</h1>
                </div>
                <div class="main-container">
                    <form action="#">
                        <div class="name">
                            <label for="name">Name</label>
                            <input type="text" placeholder="Enter Your name " id="name" name="name">
                        </div>
                        <div class="phone">
                            <label for="phone">Email or Phone</label>
                            <input type="text" name="phone" id="phone" placeholder="Enter Your Number or phone">
                        </div>
                        <div class="message">
                            <label for="message">Your message</label>
                            <textarea name="message" id="message" cols="30" rows="10"
                                placeholder="Tell us about your interests passion needs and any other details relevent to your trip"></textarea>
                        </div>
                        <button class="btn-send">
                            Send
                        </button>
                    </form>
                </div>
            </section>

            <!-- ----- -->
    </main>

    <!-- footer -->
    <footer>
        <div class="footer-image">
            <div class="overlay1"></div>
            <div class="overlay2"></div>

        </div>
        <div class="main-container">
            <div class="heading-foo">
                <img src="public/images/logo/iceland.svg" alt="">
                <h1>Nepal</h1>
                <p>EVERYTHING IS BEAUTIFUL IN ICELAND, ESPECIALLY FOOD, AND NATURE</p>
            </div>
            <div class="social-media">
                <h1>Connect with us</h1>
                <ul>
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill">
                            <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                        </svg>
                    </li>
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill">
                            <path
                                d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
                        </svg>
                    </li>
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill">
                            <path
                                d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" />
                        </svg>
                    </li>
                </ul>
            </div>
            <div class="main">
                <h1>Quick Links</h1>
                <ul>
                    <li><a href="#explore">Explore</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#tour">Tours</a></li>
                    <li><a href="#media">Media</a></li>
                </ul>
            </div>
            <div class="contact-info">
                <h1>Contacts</h1>
                <div class="contact-info-text">
                    <p>+977-9842411394</p>
                    <p>tourandhotel@help.com</p>
                </div>
            </div>
        </div>
        <div class="credit">
            <h3>üñ•Ô∏è Design and Developed By <a href="">Team ABD</a></h3>
        </div>
    </footer>

    </section>




</body>
<script>
    const getuserid = async () => {
        try {
            const response = await fetch('http://localhost:3000/api/v1/users/getuserfromtoken', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    token: getCookie('token')
                })
            })
            const data = await response.json()
            return data
        }
        catch (err) {
            console.log(err)
        }
    }
    function deleteCookie(name) {
        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
    const resultsDiv = document.getElementById('main-container')

    fetch('http://localhost:3000/api/v1/tours', {
        method: 'GET'
    })
        .then(response => response.json())
        .then(data => {


            data.data.forEach(tour => {
                const tourDiv = document.createElement('div');
                tourDiv.innerHTML = `
            <div class="tour-cards">
                        <div class="image-box">
                            <img src="https://images.unsplash.com/photo-1491466424936-e304919aada7?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=869&q=80"
                                alt="Stakkholtsgja canyon ">
                            <div class="overlay"></div>
                            <div class="image-box-text">
                                <h2>Stakkholtsgja</h2>
                                <p>Mountains & Waterfall</p>
                            </div>

                        </div>
                        <div class="tour-cards-text">
                            <h1>${tour.name}</h1>
                            <p>${tour.summary}</p>
                            <div class="price">
                                <p>${tour.price} <span>Per person</span></p>
                                <h2>Duration:${tour.duration}</h2>
                            </div>
                        </div>
                        
                        ${fetch('http://localhost:3000/api/v1/bookings')
                        .then(response => response.json())
                        .then
                    }
                        <button onClick="booktour('${tour._id}','${tour.price}')">Book Tour</button>

            </div>
      `;
                resultsDiv.appendChild(tourDiv);
            });
        })
        .catch(error => console.error(error));
    function getCookie(name) {
        const cookieValue = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
        return cookieValue ? cookieValue.pop() : '';

    }

    const ifloggedin = async () => {
        try {
            const response = await fetch('http://localhost:3000/api/v1/users/getuserfromtoken', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    token: getCookie('token')
                })
            })
            const data = await response.json()

            const namediv = document.getElementById('nameorlogin')
            namediv.href = 'logout.html'
            namediv.innerHTML = `Logout ${data.name}`
            namediv.addEventListener('click', () => {
                deleteCookie('token')
                namediv.href = 'index.html'
            })
            const addtour = document.getElementById('addtour')
            const adduser = document.getElementById('adduser')
            if (data.role == 'admin') {
                console.log(data.role)
                addtour.style.display = "block";
            }
            if (data.role == 'system-admin') {
                console.log(data.role)
                adduser.style.display = 'block'
            }
        }
        catch (err) {
            console.log(err)
        }
    }
    if (getCookie('token')) {
        console.log(getCookie('token'))
        ifloggedin()
    }
    function deleteCookie(name) {
        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
    async function booktour(tour, price) {
        const user = await getuserid()
        const userid = user._id
        const paid = false;
        try {
            const response = await fetch('http://localhost:3000/api/v1/booking', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    tour,
                    userid,
                    price,
                    paid

                })
            });

            const data = await response.json();
            if (data) {
                alert('You have booked a tour')
            }
        } catch (error) {
            console.log(error);
        }
    }
    async function canceltour(tour, price) {
        const user = await getuserid()
        const paid = false;
        try {
            const response = await fetch('http://localhost:3000/api/v1/booking', {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    tour,
                    user,
                    price,
                    paid

                })
            });

            const data = await response.json();

            console.log(data)
        } catch (error) {
            console.log(error);
        }
    }




</script>

</html>